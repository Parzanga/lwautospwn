// ==UserScript==
// @name ! LostWorld AutoSpawn
// @version 1.1
// @match *://lostworld.io/*
// @match http://149.28.108.169:4444/
// @updateURL https://raw.githubusercontent.com/Parzanga/lwautospwn/main/gag.txt
// @downloadURL https://raw.githubusercontent.com/Parzanga/lwautospwn/main/gag.txt
// ==/UserScript==

"use strict";
start();
function start() {
	console.log("Start");

	let a = (e) => document.getElementById(e), b = (e) => document.getElementsByClassName(e), c = (e) => document.getElementsByTagName(e);
	let playButton = a("joinbutton"), mainMenu = a("mainmenu");
	let autoSpawn = false, spawnKey = "KeyK", toggleHelper = "KeyL";
	let cC = (a = document.activeElement.id) => a != "createClanName" && a != "chatInput" && a != "username";
	let fltMsg = document.createElement("div");
	fltMsg.className = "gameMenu";
	fltMsg.id = "spawnText";
	fltMsg.innerHTML = "AutoSpawn Disabled";
	document.body.appendChild(fltMsg);
	fltMsg = document.createElement("div");
	fltMsg.className = "gameMenu";
	fltMsg.id = "helpMenu";
	fltMsg.innerHTML = `Enable AutoSpawn: ${spawnKey} \n Hide Menu: ${toggleHelper}`;
	document.body.appendChild(fltMsg);
	let css = `
.gameMenu {
position: absolute;
z-index: 99999999999;
color: black;
max-width: 350px;
background-color:rgba(255, 255, 255, 0.5);
border:1px solid #000;
white-space: pre-line;
}
#spawnText {
top: 45px;
left: 1px;
}
#helpMenu {
top: 1px;
left: 1px;
}
`;
	let styleShit;
	styleShit = document.createElement("style");
	document.head.appendChild(styleShit);
	styleShit.innerText = css;
	let interval, spawnText = a("spawnText"), helpMenu = a("helpMenu");
	interval = setInterval(() => {
		if (autoSpawn && cC() && mainMenu.style.display != "none") {
			playButton.click();
		}
	}, 0);
	function key(state = "keydown", keyCode = 0, code = "", key = "") {
		let event = new KeyboardEvent(state, {keyCode: keyCode, code: code, key: key});
		window.dispatchEvent(event);
	}
	function returnValue(target, propName, value) {
		return new Proxy(target, {
			get(object, property) {
				if (property == propName) return value;
				return object[property];
			}
		})
	}
	window.addEventListener("keydown", e => {
		if (cC()) {
			if (e.code == spawnKey && !e.repeat) {
				autoSpawn = !autoSpawn;
				spawnText.innerHTML = !autoSpawn ? "AutoSpawn Disabled" : "AutoSpawn Enabled";
			}
			if (e.code == toggleHelper && !e.repeat) {
				spawnText.style.display = helpMenu.style.display = spawnText.style.display == "none" ? "block" : "none";
			}
			if (e.keyCode == 32) {
				e.preventDefault();
			}
		}
	})
}
